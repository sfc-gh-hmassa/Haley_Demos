user_question,verified_query
"What are the total sales by region for the last quarter?","SELECT r.region_name, SUM(s.amount) as total_sales FROM (SELECT region_id, amount FROM sales WHERE sale_date >= DATEADD(quarter, -1, CURRENT_DATE())) s JOIN regions r ON s.region_id = r.region_id GROUP BY r.region_name ORDER BY total_sales DESC"
"Which customers have made more than 5 orders in the past year?","SELECT c.customer_id, c.customer_name, COUNT(o.order_id) as order_count FROM customers c JOIN (SELECT customer_id, order_id FROM orders WHERE order_date >= DATEADD(year, -1, CURRENT_DATE())) o ON c.customer_id = o.customer_id GROUP BY c.customer_id, c.customer_name HAVING COUNT(o.order_id) > 5"
"What is the average order value by product category?","SELECT p.category, AVG(oi.price * oi.quantity) as avg_order_value FROM (SELECT product_id, price, quantity FROM order_items) oi JOIN products p ON oi.product_id = p.product_id GROUP BY p.category ORDER BY avg_order_value DESC"
"Show me the top 10 products by revenue in the current year","SELECT p.product_name, SUM(oi.price * oi.quantity) as revenue FROM products p JOIN (SELECT product_id, price, quantity FROM order_items oi JOIN orders o ON oi.order_id = o.order_id WHERE YEAR(o.order_date) = YEAR(CURRENT_DATE())) oi ON p.product_id = oi.product_id GROUP BY p.product_id, p.product_name ORDER BY revenue DESC LIMIT 10"
"What are the monthly sales trends for each region?","SELECT r.region_name, DATE_TRUNC('month', s.sale_date) as month, SUM(s.amount) as monthly_sales FROM (SELECT region_id, sale_date, amount FROM sales WHERE sale_date >= DATEADD(year, -1, CURRENT_DATE())) s JOIN regions r ON s.region_id = r.region_id GROUP BY r.region_name, DATE_TRUNC('month', s.sale_date) ORDER BY r.region_name, month"
"Which employees have the highest sales performance?","SELECT e.employee_id, e.employee_name, SUM(s.amount) as total_sales FROM employees e JOIN (SELECT employee_id, amount FROM sales WHERE sale_date >= DATEADD(month, -6, CURRENT_DATE())) s ON e.employee_id = s.employee_id GROUP BY e.employee_id, e.employee_name ORDER BY total_sales DESC LIMIT 20"
"What is the customer retention rate by acquisition cohort?","SELECT acquisition_month, COUNT(DISTINCT customer_id) as cohort_size, COUNT(DISTINCT CASE WHEN months_since_acquisition >= 12 THEN customer_id END) as retained_customers FROM (SELECT customer_id, DATE_TRUNC('month', first_order_date) as acquisition_month, DATEDIFF('month', first_order_date, CURRENT_DATE()) as months_since_acquisition FROM customer_metrics) GROUP BY acquisition_month HAVING cohort_size > 10 ORDER BY acquisition_month"
"Show inventory levels and reorder points for all products","SELECT p.product_id, p.product_name, i.current_stock, i.reorder_point, CASE WHEN i.current_stock <= i.reorder_point THEN 'REORDER' ELSE 'OK' END as status FROM products p JOIN (SELECT product_id, current_stock, reorder_point FROM inventory WHERE last_updated >= DATEADD(day, -7, CURRENT_DATE())) i ON p.product_id = i.product_id ORDER BY p.category, p.product_name"
